<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="dark">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Setting up Pi-hole | TheHomeLab</title>
<meta name="keywords" content="">
<meta name="description" content="A guide on setting up Pi-hole for network-wide ad blocking.">
<meta name="author" content="">
<link rel="canonical" href="https://thehomelab.lol/guides/202510330_pihole/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.1a21005e5b2e95528b01b368d5bdad9a0b490b6b1cc7f8a78e9ff6adff1b3612.css" integrity="sha256-GiEAXlsulVKLAbNo1b2tmgtJC2scx/injp/2rf8bNhI=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://thehomelab.lol/logo.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://thehomelab.lol/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://thehomelab.lol/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://thehomelab.lol/apple-touch-icon.png">
<link rel="mask-icon" href="https://thehomelab.lol/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://thehomelab.lol/guides/202510330_pihole/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="https://thehomelab.lol/guides/202510330_pihole/">
  <meta property="og:site_name" content="TheHomeLab">
  <meta property="og:title" content="Setting up Pi-hole">
  <meta property="og:description" content="A guide on setting up Pi-hole for network-wide ad blocking.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="guides">
    <meta property="article:published_time" content="2023-11-30T00:00:00+00:00">
    <meta property="article:modified_time" content="2023-11-30T00:00:00+00:00">
    <meta property="og:image" content="https://thehomelab.lol/guides/202510330_pihole/cover.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://thehomelab.lol/guides/202510330_pihole/cover.png">
<meta name="twitter:title" content="Setting up Pi-hole">
<meta name="twitter:description" content="A guide on setting up Pi-hole for network-wide ad blocking.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Guides",
      "item": "https://thehomelab.lol/guides/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Setting up Pi-hole",
      "item": "https://thehomelab.lol/guides/202510330_pihole/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Setting up Pi-hole",
  "name": "Setting up Pi-hole",
  "description": "A guide on setting up Pi-hole for network-wide ad blocking.",
  "keywords": [
    
  ],
  "articleBody": "TESTING TITLE Notification System notification: Your password will expire in 30 days.\nWarning Warning: This operation will delete all data.\nSummary This is a summary using the IDEA callout!\nCan admonitions be nested? Yes!, they can. You can even use multiple layers of nesting. Before we begin, ensure you have the following:\nQNAP NAS: This guide is tailored for a QNAP NAS (e.g., TS-464) running QTS. Container Station: Installed and running on your NAS. SSH Access: Enabled on your NAS for easier management (optional but recommended). Static IP: Your NAS should have a static IP address (e.g., 192.168.1.249) to ensure DNS settings on your router remain valid. Installation We will use Docker Compose for a reproducible and easy-to-manage installation. This method allows you to define your configuration in a file, making updates and backups simple.\n1. Create the Project Directory First, create a directory for your Pi-hole configuration. You can do this via File Station or SSH.\nmkdir -p /share/Container/pihole cd /share/Container/pihole 2. Create docker-compose.yml Create a file named docker-compose.yml in your project directory with the following content:\nversion: \"3\" services: pihole: container_name: pihole image: pihole/pihole:latest # For standard setup, use host networking or map ports. # Host networking is often easier for DNS on NAS but can conflict with system ports. # We will use port mapping with a custom web port to avoid conflicts. ports: - \"53:53/tcp\" - \"53:53/udp\" # - \"67:67/udp\" # Uncomment if using Pi-hole as DHCP server - \"8080:80/tcp\" # Web interface mapped to 8080 to avoid conflict with QTS environment: TZ: 'America/Denver' # Set your timezone WEBPASSWORD: 'yoursecurepassword' # Set a secure password # QNAP Specific: Fix for DNS resolution issues in containers DNS1: 1.1.1.1 DNS2: 1.0.0.1 volumes: - './etc-pihole:/etc/pihole' - './etc-dnsmasq.d:/etc/dnsmasq.d' # Recommended: specific DNS for the container itself if you have QNAP DNS issues dns: - 127.0.0.1 - 1.1.1.1 restart: unless-stopped Note QNAP Port Conflicts: QTS often uses port 80. We mapped the Pi-hole web interface to port 8080 (8080:80/tcp). You will access the admin panel at http://:8080/admin\n3. Deploy the Container Run the following command in your project directory (via SSH) or use the “Create Application” feature in Container Station by pasting the YAML content.\ndocker compose up -d Configuration Accessing the Admin Panel Navigate to http://192.168.1.249:8080/admin in your browser. Log in with the password you set in the docker-compose.yml file.\nRecommended Settings Adlists: Go to Group Management \u003e Adlists. The default list is good, but you can add more from reputable sources like Firebog. DNS Settings: Go to Settings \u003e DNS. Upstream DNS Servers: Choose your preferred providers (e.g., Cloudflare, Google, OpenDNS). Conditional Forwarding: If you want to see local hostnames instead of IP addresses, enable this and point it to your router’s IP and local domain name. Important QNAP DNS Issue: If you experience issues where the Pi-hole container (or others) cannot resolve external domains, ensure you have explicitly set the dns key in your docker-compose.yml as shown above. QNAP’s network stack can sometimes interfere with Docker’s default DNS resolution.\nRouter Setup To make Pi-hole effective for your entire network, you need to tell your router to use your NAS’s IP address (192.168.1.249) as the DNS server.\nLog in to your router’s admin page. Find the DHCP or LAN settings (not WAN/Internet). Set the Primary DNS to 192.168.1.249. (Optional) Set a Secondary DNS to a public provider (like 1.1.1.1) if you want a fallback in case the NAS goes down, though this means some ads might slip through. Once saved, your devices will start using Pi-hole after their DHCP lease renews (or you can manually reconnect them).\n",
  "wordCount" : "598",
  "inLanguage": "en",
  "image":"https://thehomelab.lol/guides/202510330_pihole/cover.png","datePublished": "2023-11-30T00:00:00Z",
  "dateModified": "2023-11-30T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://thehomelab.lol/guides/202510330_pihole/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "TheHomeLab",
    "logo": {
      "@type": "ImageObject",
      "url": "https://thehomelab.lol/logo.png"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://thehomelab.lol/" accesskey="h" title="TheHomeLab (Alt + H)">TheHomeLab</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://thehomelab.lol/blog/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://thehomelab.lol/guides/" title="Guides">
                    <span>Guides</span>
                </a>
            </li>
            <li>
                <a href="https://thehomelab.lol/gear/" title="Gear">
                    <span>Gear</span>
                </a>
            </li>
            <li>
                <a href="https://thehomelab.lol/stack/" title="Stack">
                    <span>Stack</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://thehomelab.lol/">Home</a>&nbsp;»&nbsp;<a href="https://thehomelab.lol/guides/">Guides</a></div>
    <h1 class="post-title entry-hint-parent">
      Setting up Pi-hole
    </h1>
    <div class="post-meta"><span title='2023-11-30 00:00:00 +0000 UTC'>November 30, 2023</span>&nbsp;|&nbsp;<span>
    <a href="https://github.com/TheHomelabLOL/web-portal/edit/main/content/guides/202510330_pihole/index.md" rel="noopener noreferrer edit" target="_blank">Edit this page on GitHub</a>
</span>

</div>
  </header> 
<figure class="entry-cover">
            <img loading="eager"
                srcset='https://thehomelab.lol/guides/202510330_pihole/cover_hu_bcd5e1c80bed2f4b.png 360w,https://thehomelab.lol/guides/202510330_pihole/cover_hu_5e5b771c44f67972.png 480w,https://thehomelab.lol/guides/202510330_pihole/cover_hu_6e1e6a34e495d8c2.png 720w,https://thehomelab.lol/guides/202510330_pihole/cover_hu_fc8469edecd5b3ad.png 1080w,https://thehomelab.lol/guides/202510330_pihole/cover_hu_162d1db47fdcae5b.png 1500w,https://thehomelab.lol/guides/202510330_pihole/cover.png 1920w'
                src="https://thehomelab.lol/guides/202510330_pihole/cover.png"
                sizes="(min-width: 768px) 720px, 100vw"
                width="1920" height="995"
                alt="Pi-hole Logo">
        <figcaption>Network-wide Ad Blocking</figcaption>
</figure>
  <div class="post-content"><h2 id="testing-title">TESTING TITLE<a hidden class="anchor" aria-hidden="true" href="#testing-title">#</a></h2>

            <link rel="stylesheet" href="/css/vendors/admonitions.4fd9a0b8ec8899f2ca952048d255a569f433f77dfb3f52f5bc87e7d65cdce449.css" integrity="sha256-T9mguOyImfLKlSBI0lWlafQz9337P1L1vIfn1lzc5Ek=" crossorigin="anonymous">
    <div class="admonition notify">
      <div class="admonition-header"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M224 0c-17.7 0-32 14.3-32 32l0 19.2C119 66 64 130.6 64 208l0 18.8c0 47-17.3 92.4-48.5 127.6l-7.4 8.3c-8.4 9.4-10.4 22.9-5.3 34.4S19.4 416 32 416l384 0c12.6 0 24-7.4 29.2-18.9s3.1-25-5.3-34.4l-7.4-8.3C401.3 319.2 384 273.9 384 226.8l0-18.8c0-77.4-55-142-128-156.8L256 32c0-17.7-14.3-32-32-32zm45.3 493.3c12-12 18.7-28.3 18.7-45.3l-64 0-64 0c0 17 6.7 33.3 18.7 45.3s28.3 18.7 45.3 18.7s33.3-6.7 45.3-18.7z"/></svg>
        <span>Notification</span>
      </div>
      <div class="admonition-content">
        <p>System notification: Your password will expire in 30 days.</p>
      </div>
    </div>
    <div class="admonition warning">
      <div class="admonition-header"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480L40 480c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24l0 112c0 13.3 10.7 24 24 24s24-10.7 24-24l0-112c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"/></svg>
        <span>Warning</span>
      </div>
      <div class="admonition-content">
        <p>Warning: This operation will delete all data.</p>
      </div>
    </div>
    <div class="admonition idea">
      <div class="admonition-header"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M272 384c9.6-31.9 29.5-59.1 49.2-86.2c0 0 0 0 0 0c5.2-7.1 10.4-14.2 15.4-21.4c19.8-28.5 31.4-63 31.4-100.3C368 78.8 289.2 0 192 0S16 78.8 16 176c0 37.3 11.6 71.9 31.4 100.3c5 7.2 10.2 14.3 15.4 21.4c0 0 0 0 0 0c19.8 27.1 39.7 54.4 49.2 86.2l160 0zM192 512c44.2 0 80-35.8 80-80l0-16-160 0 0 16c0 44.2 35.8 80 80 80zM112 176c0 8.8-7.2 16-16 16s-16-7.2-16-16c0-61.9 50.1-112 112-112c8.8 0 16 7.2 16 16s-7.2 16-16 16c-44.2 0-80 35.8-80 80z"/></svg>
        <span>Summary</span>
      </div>
      <div class="admonition-content">
        <p>This is a summary using the <code>IDEA</code> callout!</p>
      </div>
    </div>
    <div class="admonition question">
      <div class="admonition-header"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM169.8 165.3c7.9-22.3 29.1-37.3 52.8-37.3l58.3 0c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24l0-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1l-58.3 0c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"/></svg>
        <span>Can admonitions be nested?</span>
      </div>
      <div class="admonition-content">
        
    <div class="admonition note">
      <div class="admonition-header"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M0 64C0 28.7 28.7 0 64 0L224 0l0 128c0 17.7 14.3 32 32 32l128 0 0 125.7-86.8 86.8c-10.3 10.3-17.5 23.1-21 37.2l-18.7 74.9c-2.3 9.2-1.8 18.8 1.3 27.5L64 512c-35.3 0-64-28.7-64-64L0 64zm384 64l-128 0L256 0 384 128zM549.8 235.7l14.4 14.4c15.6 15.6 15.6 40.9 0 56.6l-29.4 29.4-71-71 29.4-29.4c15.6-15.6 40.9-15.6 56.6 0zM311.9 417L441.1 287.8l71 71L382.9 487.9c-4.1 4.1-9.2 7-14.9 8.4l-60.1 15c-5.5 1.4-11.2-.2-15.2-4.2s-5.6-9.7-4.2-15.2l15-60.1c1.4-5.6 4.3-10.8 8.4-14.9z"/></svg>
        <span>Yes!, they can.</span>
      </div>
      <div class="admonition-content">
        
    <div class="admonition example">
      <div class="admonition-header"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M192 96a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm-8 384l0-128 16 0 0 128c0 17.7 14.3 32 32 32s32-14.3 32-32l0-288 56 0 64 0 16 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-16 0 0-64 192 0 0 192-192 0 0-32-64 0 0 48c0 26.5 21.5 48 48 48l224 0c26.5 0 48-21.5 48-48l0-224c0-26.5-21.5-48-48-48L368 0c-26.5 0-48 21.5-48 48l0 80-76.9 0-65.9 0c-33.7 0-64.9 17.7-82.3 46.6l-58.3 97c-9.1 15.1-4.2 34.8 10.9 43.9s34.8 4.2 43.9-10.9L120 256.9 120 480c0 17.7 14.3 32 32 32s32-14.3 32-32z"/></svg>
        <span>You can even use multiple layers of nesting.</span>
      </div>
    </div>
      </div>
    </div>
      </div>
    </div><p>Before we begin, ensure you have the following:</p>
<ul>
<li><strong>QNAP NAS</strong>: This guide is tailored for a QNAP NAS (e.g., TS-464) running QTS.</li>
<li><strong>Container Station</strong>: Installed and running on your NAS.</li>
<li><strong>SSH Access</strong>: Enabled on your NAS for easier management (optional but recommended).</li>
<li><strong>Static IP</strong>: Your NAS should have a static IP address (e.g., <code>192.168.1.249</code>) to ensure DNS settings on your router remain valid.</li>
</ul>
<h2 id="installation">Installation<a hidden class="anchor" aria-hidden="true" href="#installation">#</a></h2>
<p>We will use <strong>Docker Compose</strong> for a reproducible and easy-to-manage installation. This method allows you to define your configuration in a file, making updates and backups simple.</p>
<h3 id="1-create-the-project-directory">1. Create the Project Directory<a hidden class="anchor" aria-hidden="true" href="#1-create-the-project-directory">#</a></h3>
<p>First, create a directory for your Pi-hole configuration. You can do this via File Station or SSH.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir -p /share/Container/pihole
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> /share/Container/pihole
</span></span></code></pre></div><h3 id="2-create-docker-composeyml">2. Create <code>docker-compose.yml</code><a hidden class="anchor" aria-hidden="true" href="#2-create-docker-composeyml">#</a></h3>
<p>Create a file named <code>docker-compose.yml</code> in your project directory with the following content:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">pihole</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">pihole</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">pihole/pihole:latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># For standard setup, use host networking or map ports.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># Host networking is often easier for DNS on NAS but can conflict with system ports.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># We will use port mapping with a custom web port to avoid conflicts.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;53:53/tcp&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;53:53/udp&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># - &#34;67:67/udp&#34; # Uncomment if using Pi-hole as DHCP server</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;8080:80/tcp&#34;</span><span class="w"> </span><span class="c"># Web interface mapped to 8080 to avoid conflict with QTS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TZ</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;America/Denver&#39;</span><span class="w"> </span><span class="c"># Set your timezone</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">WEBPASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;yoursecurepassword&#39;</span><span class="w"> </span><span class="c"># Set a secure password</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># QNAP Specific: Fix for DNS resolution issues in containers</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">DNS1</span><span class="p">:</span><span class="w"> </span><span class="m">1.1.1.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">DNS2</span><span class="p">:</span><span class="w"> </span><span class="m">1.0.0.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s1">&#39;./etc-pihole:/etc/pihole&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s1">&#39;./etc-dnsmasq.d:/etc/dnsmasq.d&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># Recommended: specific DNS for the container itself if you have QNAP DNS issues</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">dns</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">127.0.0.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">1.1.1.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">unless-stopped</span><span class="w">
</span></span></span></code></pre></div>
    <details class="admonition note">
      <summary class="admonition-header"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M0 64C0 28.7 28.7 0 64 0L224 0l0 128c0 17.7 14.3 32 32 32l128 0 0 125.7-86.8 86.8c-10.3 10.3-17.5 23.1-21 37.2l-18.7 74.9c-2.3 9.2-1.8 18.8 1.3 27.5L64 512c-35.3 0-64-28.7-64-64L0 64zm384 64l-128 0L256 0 384 128zM549.8 235.7l14.4 14.4c15.6 15.6 15.6 40.9 0 56.6l-29.4 29.4-71-71 29.4-29.4c15.6-15.6 40.9-15.6 56.6 0zM311.9 417L441.1 287.8l71 71L382.9 487.9c-4.1 4.1-9.2 7-14.9 8.4l-60.1 15c-5.5 1.4-11.2-.2-15.2-4.2s-5.6-9.7-4.2-15.2l15-60.1c1.4-5.6 4.3-10.8 8.4-14.9z"/></svg>
        <span>Note</span>
      </summary>
      <div class="admonition-content">
        <p><strong>QNAP Port Conflicts</strong>: QTS often uses port 80. We mapped the Pi-hole web interface to port <strong>8080</strong> (<code>8080:80/tcp</code>). You will access the admin panel at <code>http://&lt;NAS_IP&gt;:8080/admin</code></p>
      </div>
    </details><h3 id="3-deploy-the-container">3. Deploy the Container<a hidden class="anchor" aria-hidden="true" href="#3-deploy-the-container">#</a></h3>
<p>Run the following command in your project directory (via SSH) or use the &ldquo;Create Application&rdquo; feature in Container Station by pasting the YAML content.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker compose up -d
</span></span></code></pre></div><h2 id="configuration">Configuration<a hidden class="anchor" aria-hidden="true" href="#configuration">#</a></h2>
<h3 id="accessing-the-admin-panel">Accessing the Admin Panel<a hidden class="anchor" aria-hidden="true" href="#accessing-the-admin-panel">#</a></h3>
<p>Navigate to <code>http://192.168.1.249:8080/admin</code> in your browser. Log in with the password you set in the <code>docker-compose.yml</code> file.</p>
<h3 id="recommended-settings">Recommended Settings<a hidden class="anchor" aria-hidden="true" href="#recommended-settings">#</a></h3>
<ol>
<li><strong>Adlists</strong>: Go to <strong>Group Management &gt; Adlists</strong>. The default list is good, but you can add more from reputable sources like <a href="https://firebog.net/">Firebog</a>.</li>
<li><strong>DNS Settings</strong>: Go to <strong>Settings &gt; DNS</strong>.
<ul>
<li><strong>Upstream DNS Servers</strong>: Choose your preferred providers (e.g., Cloudflare, Google, OpenDNS).</li>
<li><strong>Conditional Forwarding</strong>: If you want to see local hostnames instead of IP addresses, enable this and point it to your router&rsquo;s IP and local domain name.</li>
</ul>
</li>
</ol>

    <div class="admonition important">
      <div class="admonition-header"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-384c13.3 0 24 10.7 24 24l0 112c0 13.3-10.7 24-24 24s-24-10.7-24-24l0-112c0-13.3 10.7-24 24-24zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"/></svg>
        <span>Important</span>
      </div>
      <div class="admonition-content">
        <p><strong>QNAP DNS Issue</strong>: If you experience issues where the Pi-hole container (or others) cannot resolve external domains, ensure you have explicitly set the <code>dns</code> key in your <code>docker-compose.yml</code> as shown above. QNAP&rsquo;s network stack can sometimes interfere with Docker&rsquo;s default DNS resolution.</p>
      </div>
    </div><h2 id="router-setup">Router Setup<a hidden class="anchor" aria-hidden="true" href="#router-setup">#</a></h2>
<p>To make Pi-hole effective for your entire network, you need to tell your router to use your NAS&rsquo;s IP address (<code>192.168.1.249</code>) as the DNS server.</p>
<ol>
<li>Log in to your router&rsquo;s admin page.</li>
<li>Find the <strong>DHCP</strong> or <strong>LAN</strong> settings (not WAN/Internet).</li>
<li>Set the <strong>Primary DNS</strong> to <code>192.168.1.249</code>.</li>
<li>(Optional) Set a Secondary DNS to a public provider (like <code>1.1.1.1</code>) if you want a fallback in case the NAS goes down, though this means some ads might slip through.</li>
</ol>
<p>Once saved, your devices will start using Pi-hole after their DHCP lease renews (or you can manually reconnect them).</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="next" href="https://thehomelab.lol/blog/ai_editor/">
    <span class="title">Next »</span>
    <br>
    <span>AI Editor</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://thehomelab.lol/">TheHomeLab</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
